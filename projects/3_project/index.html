<!DOCTYPE html> <html lang="en"> <head> <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title>Astronomical Spectroscopy Project | Ethan J. Wadhwa</title> <meta name="author" content="Ethan J. Wadhwa"> <meta name="description" content="Class project for observational astrophysics course PHYS 164 at UCSD"> <link rel="stylesheet" href="/assets/css/bootstrap.min.css?a4b3f509e79c54a512b890d73235ef04"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"> <link defer rel="stylesheet" href="https://unpkg.com/bootstrap-table@1.22.1/dist/bootstrap-table.min.css"> <link rel="stylesheet" href="/assets/css/academicons.min.css?f0b7046b84e425c55f3463ac249818f5"> <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons"> <link rel="stylesheet" href="/assets/css/jekyll-pygments-themes-github.css?19f3075a2d19613090fe9e16b564e1fe" media="" id="highlight_theme_light"> <link rel="shortcut icon" href="data:image/svg+xml,&lt;svg%20xmlns=%22http://www.w3.org/2000/svg%22%20viewBox=%220%200%20100%20100%22&gt;&lt;text%20y=%22.9em%22%20font-size=%2290%22&gt;%E2%9A%9B%EF%B8%8F&lt;/text&gt;&lt;/svg&gt;"> <link rel="stylesheet" href="/assets/css/main.css?d41d8cd98f00b204e9800998ecf8427e"> <link rel="canonical" href="https://ethan-wadhwa.github.io/projects/3_project/"> <link rel="stylesheet" href="/assets/css/jekyll-pygments-themes-native.css?e74e74bf055e5729d44a7d031a5ca6a5" media="none" id="highlight_theme_dark"> <script src="/assets/js/theme.js?96d6b3e1c3604aca8b6134c7afdd5db6"></script> <script src="/assets/js/dark_mode.js?9b17307bb950ffa2e34be0227f53558f"></script> </head> <body class="fixed-top-nav "> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top"> <div class="container"> <a class="navbar-brand title font-weight-lighter" href="/"><span class="font-weight-bold">Ethan </span>J. Wadhwa</a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/">About</a> </li> <li class="nav-item "> <a class="nav-link" href="/projects/">Projects</a> </li> <li class="nav-item "> <a class="nav-link" href="/courses/">Courses</a> </li> <li class="nav-item "> <a class="nav-link" href="/cv/">CV</a> </li> <li class="toggle-container"> <button id="light-toggle" title="Change theme"> <i class="fas fa-moon"></i> <i class="fas fa-sun"></i> </button> </li> </ul> </div> </div> </nav> <progress id="progress" value="0"> <div class="progress-container"> <span class="progress-bar"></span> </div> </progress> </header> <div class="container mt-5"> <div class="post"> <header class="post-header"> <h1 class="post-title">Astronomical Spectroscopy Project</h1> <p class="post-description">Class project for observational astrophysics course PHYS 164 at UCSD</p> </header> <article> <div class="caption"> <h3>Abstract</h3> In order to understand how astronomers use spectroscopy and spectrometry to measure physical properties of stellar objects, we analyzed two datasets of spectral data. The first dataset was obtained from a handheld spectrograph used to find the emission spectra of several elements. The second dataset was from the KAST spectrometer, a detector in the Shane telescope of the Lick Observatory. We use the handheld spectrograph dataset to develop an algorithm to find the centroids of the emission spectrum in order to relate observed emission spectra to the pixel value of the detection. Using the least squares linear fitting algorithm, we find a wavelength resolution for both spectrographs with an error of σ = 7.686 pixels. Using these measurements and algorithms, we characterize the chemical composition of several stars from their observed spectra to find their spectral classification. </div> <h2>1 Introduction </h2> <p>To understand spectroscopy, one must understand what a spectrum is and where it comes from. When a beam of light is diffracted, it separates into the wavelengths of light that make up that beam. We call these wavelengths a spectrum as it is the spectrum of wavelengths that make up the observed light from a source. These spectral lines tell us a lot about the physical properties of the source of the light. From Kirchoff’s Laws of Spectra, we have three types of spectral phenomena:</p> <ol> <li> <p>A continuous spectrum which is produced by a hot solid, liquid, or dense gas</p> </li> <li> <p>An emission line spectrum which is produced by hot gas</p> </li> <li> <p>An absorption spectrum which is produced by a cold gas lying in front of a continuous spectrum.</p> </li> </ol> <p>Most astronomical bodies produce a continuous spectrum, which is approximated by the spectrum produced from thermal radiation called blackbody radiation. This radiation relies only on the temperature of the object, The spectral radiance (the power radiated per solid angle per area per wavelength at wavelength λ at temperature T) is given by Planck’s Law:</p> <div class="row"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <img src="/assets/img/eq1_lab2.JPG" class="img-fluid rounded z-depth-1" width="auto" height="auto" title="eq1" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <p>When multiplied by the total solid angle of a sphere (4π), we get the equation for spectral irradiance, the power radiated per area per wavelength of the astronomical body dependent on temperature:</p> <div class="row"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <img src="/assets/img/eq2_lab2.JPG" class="img-fluid rounded z-depth-1" width="auto" height="auto" title="eq2" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <p>From this we can derive the body’s effective temperature from the maximum wavelength of light emitted by the body through Wein’s displacement law:</p> <div class="row"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <img src="/assets/img/eq3_lab2.JPG" class="img-fluid rounded z-depth-1" width="auto" height="auto" title="eq3" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <h2> 2 Observation and Data </h2> <h4> 2.1 Collection of Data </h4> <p>To gather the data needed for this lab, we used two main devices to gather the data: a Ocean Optics USB 2000 spectrometer and the blue arm KAST spectrograph, a spectrograph mounted on the Shane telescope in the Lick Observatory.</p> <p>The data from the Ocean Optics USB 2000 spectrometer was gathered by students in the winter 2020 UCSD observational astrophysics research lab due to the remote nature of the class the quarter this lab was done in (winter 2021). The data collected by the USB 2000 consisted of several frames of emission lines of four elements, Hydrogen, Mercury, Helium, and Neon, as well as one arc lamp containing several elements.</p> <p>The second dataset from the KAST Spectrograph was taken on October 26th, 2013 and accessed by students for this lab on February 2nd, 2022. The dataset from the KAST Spectrograph consists of bias frames, dome flatfield frames, and spectral frames that contain the continuous spectrum of astronomical sources containing both emission and absorption lines.</p> <h4> 2.2 Instrumentation </h4> <h5> 2.2.1 Ocean Optics USB 2000 Spectrometer </h5> <p>The Ocean Optics USB 2000 Spectrometer is a handheld spectrometer that focuses light from a source then diffracts it onto an array of detectors. The technical layout of this spectrometer is shown in Figure 2 in appendix 6.2. The USB 2000 used for this lab observes wavelengths between 336 and 1027nm with a spectral resolution of ~0.4nm. The detector uses an array of CCDs to count the intensity at each wavelength and converts the intensities to ADU with a conversion ratio of 12 ADU per electron.</p> <h5> 2.2.2 KAST Spectrometer Blue Arm </h5> <p>The KAST Spectrograph is a camera mounted on the Shane Telescope which is located in the Lick Observatory on Mount Hamilton, just east of San Jose, California. The KAST Spectrograph is actually two spectrographs, one optimized for blue wavelengths and one optimized for red wavelengths. They are mounted in such a way that both can be used at the same time if desired. For the datasets for this experiment, we used the KAST Spectrograph’s blue arm as we are looking at primarily blue wavelengths for emission and absorption spectra. A technical schematic of the KAST double spectrograph is shown in figure 3 in appendix 6.3.</p> <h4> Displaying Data </h4> <p>To better represent the datasets used for this lab, we averaged all frames of each spectral emission obtained from the USB2000. This allows us to analyze each element’s spectrum as a singular entity instead of as the large number of files for each element’s spectral emissions. In figure 4, we can see the spectral emissions of hydrogen, helium, and mercury.</p> <div class="row"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <img src="/assets/img/fig4_lab2.JPG" class="img-fluid rounded z-depth-1" width="auto" height="auto" title="fig4" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <div class="caption"> Figure 4: Spectral emission lines of hydrogen, mercury, and helium from the datasets recorded from the USB2000 handheld spectrometer </div> <p>We can see the peaks of these datasets are excessively saturated, which is very apparent for helium and hydrogen. Neon was the only spectra that did not exhibit these excessively saturated peaks, and was not included in this figure because of it. This is an error that cannot be corrected for, and it slightly offsets centroids at the saturated peaks which are found in this case using the FWHM method.</p> <h2> 3 Data Reduction &amp; Methods </h2> <h4> 3.1 Centroiding Spectral lines </h4> <p>To convert the datasets from having a x-axis of pixel # to qualitative data with a x-axis of wavelength, we need to calibrate the datasets from the spectrometer using the peak wavelengths of known emission lines. To calibrate our spectral datasets, we must find the centroids of the emission spectra. The centroids are not the pixel locations of highest intensity, but rather are the pixel locations of the center of the intensity spikes of the spectrum. The centroids of the intensity spikes are more useful than the peaks because they aren’t as reliant on spectral resolution and because we don’t observe the highest intensity wavelengths at just one pixel. To find the centroids of these spectral emission intensities for this lab, we use several methods to calculate the centroids of each intensity spike. Firstly, set a threshold limit of two times the minimum intensity value in each dataset as the limit that all peak intensities would be over. Next, find the peaks of the emission spectra. Once the peaks have been found, we iterated over the 30 pixels before and 30 pixels after each peak to find the points above half of the maximum intensity of each spike. This is called the Full Width Half Maximum (FWHM) method. The median value between the two half maximum points of each intensity spike was calculated as the centroid.</p> <div class="row"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <img src="/assets/img/fig5_lab2.JPG" class="img-fluid rounded z-depth-1" width="auto" height="auto" title="fig5" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <div class="caption"> Figure 5: Spectrum of Helium with the centroids of each emission line </div> <h4> 3.2 Converting Wavelength &amp; Least Squares Linear Fitting </h4> <p>To convert from pixel number to wavelength, we need to fit the centroids of the datasets to the actual observed emission intensities of elements. To perform this fit, we follow the Least Squares Linear Fitting method (Least Squares fit). A linear equation takes the form y = m*x + b. To fit a function linearly with the least squares method, we must find the minimum value of:</p> <div class="row"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <img src="/assets/img/eq4_lab2.JPG" class="img-fluid rounded z-depth-1" width="auto" height="auto" title="eq4" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <p>The most likely values of m and c are present at the minimum possible Chi value. These values can be found by solving:</p> <div class="row"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <img src="/assets/img/eq5_lab2.JPG" class="img-fluid rounded z-depth-1" width="auto" height="auto" title="eq5" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <p>These are solved to have the form:</p> <div class="row"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <img src="/assets/img/eq6_lab2.JPG" class="img-fluid rounded z-depth-1" width="auto" height="auto" title="eq6" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <p>These equations give us our two functions to find m and c from any x and y inputs. TO make computations smoother for jupyterhub, we change the form of these equations to a singular matrix equation that we use to perform our fit taking the form of:</p> <div class="row"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <img src="/assets/img/eq7_lab2.JPG" class="img-fluid rounded z-depth-1" width="auto" height="auto" title="eq7" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <p>Now, we can clearly see that by multiplying both sides of this equation by the inverse of the first matrix, we will get this function in terms of m and c from our x and y inputs (corresponding to centroid pixel and wavelength respectively). The error in this calculation is given in units of pixels and the equations:</p> <div class="row"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <img src="/assets/img/eq8_lab2.JPG" class="img-fluid rounded z-depth-1" width="auto" height="auto" title="eq8" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <p>Where σ is the variance in the system given by:</p> <div class="row"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <img src="/assets/img/eq9_lab2.JPG" class="img-fluid rounded z-depth-1" width="auto" height="auto" title="eq9" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <p>This method allows us to identify the correlation between pixel number and wavelength so we can convert our datasets from observed intensity per pixel to observed intensity per wavelength.</p> <h4> 3.3 Bias Subtraction and Flatfield Correction </h4> <p>The spectral data of astronomical sources from the KAST spectrograph must be reduced in order to account for the bias noise and the individual pixel sensitivity in the detector. The first step in this is very straightforward, we simply subtract the average of the bias frames from any other frames we are using to account for the inherent noise in the system. The next main step is to account for the pixel sensitivity. To do this, we need to use a flatfield correction, in which we record several frames of a ‘flatfield’ which is a frame of a constant source with known intensity. We normalize these flatfield frames by first taking the average of the flatfield frames, then subtracting the bias, then dividing by the median of the flatfield minus the bias.</p> <div class="row"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <img src="/assets/img/eq10_lab2.JPG" class="img-fluid rounded z-depth-1" width="auto" height="auto" title="eq10" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <p>This normalized flatfield frame tells us how sensitive each pixel is to light, so by scaling our science frames by the normalized flatfield, we can better visualize the spectrum and can separate out rows of detectors for analysis. The full flatfield and bias correction to each science frame is equal to:</p> <div class="row"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <img src="/assets/img/eq11_lab2.JPG" class="img-fluid rounded z-depth-1" width="auto" height="auto" title="eq11" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <div class="row"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <img src="/assets/img/fig6_lab2.JPG" class="img-fluid rounded z-depth-1" width="auto" height="auto" title="fig6" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <div class="caption"> Figure 6: Averaged and normalized flat field frames, with ADU count scales shown on the right. </div> <p>We can see the need for the flatfield and bias correction here as one can clearly see the impact of the pixel intensities causing a large dispersion in intensity values across the detector.</p> </article> </div> </div> <footer class="fixed-bottom"> <div class="container mt-0"> © Copyright 2023 Ethan J. Wadhwa. Powered by <a href="https://jekyllrb.com/" target="_blank" rel="external nofollow noopener">Jekyll</a> with <a href="https://github.com/alshedivat/al-folio" rel="external nofollow noopener" target="_blank">al-folio</a> theme. Hosted by <a href="https://pages.github.com/" target="_blank" rel="external nofollow noopener">GitHub Pages</a>. </div> </footer> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script src="/assets/js/bootstrap.bundle.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/masonry-layout@4.2.2/dist/masonry.pkgd.min.js" integrity="sha256-Nn1q/fx0H7SNLZMQ5Hw5JLaTRZp0yILA/FRexe19VdI=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/imagesloaded@4/imagesloaded.pkgd.min.js"></script> <script defer src="/assets/js/masonry.js" type="text/javascript"></script> <script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.0.8/dist/medium-zoom.min.js" integrity="sha256-7PhEpEWEW0XXQ0k6kQrPKwuoIomz8R8IYyuU1Qew4P8=" crossorigin="anonymous"></script> <script defer src="/assets/js/zoom.js?7b30caa5023af4af8408a472dc4e1ebb"></script> <script defer src="https://unpkg.com/bootstrap-table@1.22.1/dist/bootstrap-table.min.js"></script> <script src="/assets/js/no_defer.js?d633890033921b33e0ceb13d22340a9c"></script> <script defer src="/assets/js/common.js?acdb9690d7641b2f8d40529018c71a01"></script> <script defer src="/assets/js/copy_code.js?c9d9dd48933de3831b3ee5ec9c209cac" type="text/javascript"></script> <script async src="https://d1bxh8uas1mnw7.cloudfront.net/assets/embed.js"></script> <script async src="https://badge.dimensions.ai/badge.js"></script> <script type="text/javascript">window.MathJax={tex:{tags:"ams"}};</script> <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.0/es5/tex-mml-chtml.js"></script> <script defer src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script> <script type="text/javascript">function progressBarSetup(){"max"in document.createElement("progress")?(initializeProgressElement(),$(document).on("scroll",function(){progressBar.attr({value:getCurrentScrollPosition()})}),$(window).on("resize",initializeProgressElement)):(resizeProgressBar(),$(document).on("scroll",resizeProgressBar),$(window).on("resize",resizeProgressBar))}function getCurrentScrollPosition(){return $(window).scrollTop()}function initializeProgressElement(){let e=$("#navbar").outerHeight(!0);$("body").css({"padding-top":e}),$("progress-container").css({"padding-top":e}),progressBar.css({top:e}),progressBar.attr({max:getDistanceToScroll(),value:getCurrentScrollPosition()})}function getDistanceToScroll(){return $(document).height()-$(window).height()}function resizeProgressBar(){progressBar.css({width:getWidthPercentage()+"%"})}function getWidthPercentage(){return getCurrentScrollPosition()/getDistanceToScroll()*100}const progressBar=$("#progress");window.onload=function(){setTimeout(progressBarSetup,50)};</script> </body> </html>